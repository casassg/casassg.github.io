<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan de Gimnasio</title>
    <!-- Carga de Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- Carga de la fuente Inter --><link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Alpine.js --><script src="https://unpkg.com/alpinejs@3.13.10/dist/cdn.min.js" defer></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        [x-cloak] { display: none; }
        .tab-button.active {
            border-color: #4f46e5; color: #4f46e5; background-color: #eef2ff;
        }
        .tab-button { border-color: transparent; }
        .exercise-item input:checked + label {
            text-decoration: line-through; opacity: 0.6;
        }
        .exercise-item input:checked + label .check-icon {
            opacity: 1;
        }
        .check-icon {
            opacity: 0; transition: opacity 0.2s;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 p-4 md:p-8">

    <div class="max-w-2xl mx-auto" x-data="gymApp()" x-init="init()">
        <header class="text-center mb-6">
            <h1 class="text-3xl font-bold text-indigo-700">Mi Rutina de Gimnasio</h1>
            <p class="text-gray-600 mt-1">Tu plan de entrenamiento adaptado.</p>
            
            <div x-show="!progression.optedIntoFull" class="mt-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-4 border border-indigo-200">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="text-lg font-semibold text-indigo-900" x-text="getPhaseTitle()"></h3>
                    <span class="text-sm font-medium text-indigo-600" x-text="'Semana ' + progression.currentWeek"></span>
                </div>
                
                <div class="w-full bg-indigo-200 rounded-full h-2 mb-3">
                    <div class="bg-indigo-600 h-2 rounded-full transition-all duration-500" :style="'width: ' + getProgressPercentage() + '%'"></div>
                </div>
                
                <div class="flex items-start gap-2 text-sm text-gray-700 mb-3">
                    <span>üìÖ</span>
                    <div>
                        <p class="font-medium" x-text="'Entrena: ' + getRecommendedDays()"></p>
                        <p class="text-xs text-gray-600 mt-1" x-text="getPhaseGuidance()"></p>
                    </div>
                </div>
                
                <div x-show="shouldSuggestAdvancement()" class="bg-green-50 border border-green-200 rounded-lg p-3 mb-2">
                    <p class="text-sm font-medium text-green-800 mb-2">üéâ ¬°Gran progreso! ¬øListo para avanzar?</p>
                    <button @click="advancePhase()" class="bg-green-600 hover:bg-green-700 text-white text-sm font-medium px-4 py-2 rounded-lg transition-colors">
                        Avanzar a siguiente fase
                    </button>
                </div>
                
                <div class="flex gap-2 text-xs flex-wrap">
                    <button @click="previousWeek()" class="text-indigo-600 hover:text-indigo-800 font-medium">
                        ‚Üê Semana anterior
                    </button>
                    <span class="text-gray-400">|</span>
                    <button @click="nextWeek()" class="text-indigo-600 hover:text-indigo-800 font-medium">
                        Siguiente semana ‚Üí
                    </button>
                    <span class="text-gray-400">|</span>
                    <button @click="skipToFull()" class="text-indigo-600 hover:text-indigo-800 font-medium">
                        Saltar al programa completo
                    </button>
                    <span class="text-gray-400">|</span>
                    <button @click="resetProgression()" class="text-gray-500 hover:text-gray-700">
                        Reiniciar progresi√≥n
                    </button>
                </div>
            </div>
            
            <div x-show="progression.optedIntoFull" class="mt-4">
                <button @click="resetProgression()" class="text-sm text-indigo-600 hover:text-indigo-800 font-medium">
                    ‚Üê Volver al programa progresivo
                </button>
            </div>
        </header>

        <div class="w-full bg-white rounded-2xl shadow-lg p-4 md:p-6" x-data="{ activeTab: 'lunes' }">
            <!-- Navegaci√≥n de TABS --><nav class="flex overflow-x-auto border-b border-gray-200 -mx-4 px-4 mb-4">
                <button @click="activeTab = 'lunes'" :class="activeTab === 'lunes' ? 'active' : ''" class="tab-button flex-shrink-0 text-gray-500 font-medium border-b-2 py-3 px-4 rounded-t-lg transition-colors duration-200 ease-in-out" x-show="shouldShowDay('lunes')">Lunes</button>
                <button @click="activeTab = 'martes'" :class="activeTab === 'martes' ? 'active' : ''" class="tab-button flex-shrink-0 text-gray-500 font-medium border-b-2 py-3 px-4 rounded-t-lg transition-colors duration-200 ease-in-out" x-show="shouldShowDay('martes')">Martes</button>
                <button @click="activeTab = 'miercoles'" :class="activeTab === 'miercoles' ? 'active' : ''" class="tab-button flex-shrink-0 text-gray-500 font-medium border-b-2 py-3 px-4 rounded-t-lg transition-colors duration-200 ease-in-out" x-show="shouldShowDay('miercoles')">Mi√©rcoles</button>
                <button @click="activeTab = 'jueves'" :class="activeTab === 'jueves' ? 'active' : ''" class="tab-button flex-shrink-0 text-gray-500 font-medium border-b-2 py-3 px-4 rounded-t-lg transition-colors duration-200 ease-in-out" x-show="shouldShowDay('jueves')">Jueves</button>
                <button @click="activeTab = 'viernes'" :class="activeTab === 'viernes' ? 'active' : ''" class="tab-button flex-shrink-0 text-gray-500 font-medium border-b-2 py-3 px-4 rounded-t-lg transition-colors duration-200 ease-in-out" x-show="shouldShowDay('viernes')">Viernes</button>
                <button @click="activeTab = 'sabado'" :class="activeTab === 'sabado' ? 'active' : ''" class="tab-button flex-shrink-0 text-gray-500 font-medium border-b-2 py-3 px-4 rounded-t-lg transition-colors duration-200 ease-in-out" x-show="shouldShowDay('sabado')">S√°bado</button>
            </nav>

            <!-- Contenido de los TABS --><div class="space-y-6">
                
                <!-- LUNES --><div x-show="activeTab === 'lunes'" x-cloak class="space-y-4">
                    <h2 class="text-xl font-semibold text-indigo-600">Pecho / B√≠cep / Hombro</h2>
                    <template x-for="(exercise, index) in getFilteredExercises('lunes')" :key="index">
                        <div class="exercise-item">
                            <input :id="'lunes-' + index" type="checkbox" class="hidden" x-model="exercise.completed" @change="saveProgress()">
                            <label :for="'lunes-' + index" 
                                   class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 cursor-pointer border border-gray-200">
                                <div class="mr-4 flex-shrink-0 w-12 h-12 flex items-center justify-center text-3xl">
                                    <span x-text="getIcon(exercise.type)"></span>
                                </div>
                                
                                <div class="flex-1 min-w-0">
                                    <span class="font-medium text-gray-800" x-text="exercise.name"></span>
                                    <span class="block text-sm text-gray-500" x-text="getAdjustedSets(exercise.sets)"></span>
                                </div>

                                <div class="w-6 h-6 ml-3 flex-shrink-0 rounded-md border-2 border-gray-300 flex items-center justify-center transition-all duration-200"
                                     :class="{ 'bg-indigo-600 border-indigo-600': exercise.completed }">
                                    <svg class="w-4 h-4 text-white check-icon" :class="{ 'check-icon': !exercise.completed }" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                </div>
                            </label>
                            <div class="pl-16 pr-3 pb-2 pt-1 text-sm text-gray-600" x-text="exercise.description"></div>
                        </div>
                    </template>
                    <button @click="clearDay('lunes')" class="w-full text-center text-sm text-gray-500 hover:text-red-500 transition-colors duration-200 mt-4">Limpiar checks</button>
                </div>

                <!-- MARTES --><div x-show="activeTab === 'martes'" x-cloak class="space-y-4">
                    <h2 class="text-xl font-semibold text-indigo-600">Espalda / Tr√≠cep</h2>
                    <template x-for="(exercise, index) in getFilteredExercises('martes')" :key="index">
                        <div class="exercise-item">
                            <input :id="'martes-' + index" type="checkbox" class="hidden" x-model="exercise.completed" @change="saveProgress()">
                            <label :for="'martes-' + index" 
                                   class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 cursor-pointer border border-gray-200">
                                <div class="mr-4 flex-shrink-0 w-12 h-12 flex items-center justify-center text-3xl">
                                    <span x-text="getIcon(exercise.type)"></span>
                                </div>
                                
                                <div class="flex-1 min-w-0">
                                    <span class="font-medium text-gray-800" x-text="exercise.name"></span>
                                    <span class="block text-sm text-gray-500" x-text="getAdjustedSets(exercise.sets)"></span>
                                </div>

                                <div class="w-6 h-6 ml-3 flex-shrink-0 rounded-md border-2 border-gray-300 flex items-center justify-center transition-all duration-200"
                                     :class="{ 'bg-indigo-600 border-indigo-600': exercise.completed }">
                                    <svg class="w-4 h-4 text-white check-icon" :class="{ 'check-icon': !exercise.completed }" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                </div>
                            </label>
                            <div class="pl-16 pr-3 pb-2 pt-1 text-sm text-gray-600" x-text="exercise.description"></div>
                        </div>
                    </template>
                    <button @click="clearDay('martes')" class="w-full text-center text-sm text-gray-500 hover:text-red-500 transition-colors duration-200 mt-4">Limpiar checks</button>
                </div>

                <!-- MI√âRCOLES --><div x-show="activeTab === 'miercoles'" x-cloak class="space-y-4">
                    <h2 class="text-xl font-semibold text-indigo-600">Pierna</h2>
                    <template x-for="(exercise, index) in getFilteredExercises('miercoles')" :key="index">
                        <div class="exercise-item">
                            <input :id="'miercoles-' + index" type="checkbox" class="hidden" x-model="exercise.completed" @change="saveProgress()">
                            <label :for="'miercoles-' + index" 
                                   class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 cursor-pointer border border-gray-200">
                                <div class="mr-4 flex-shrink-0 w-12 h-12 flex items-center justify-center text-3xl">
                                    <span x-text="getIcon(exercise.type)"></span>
                                </div>
                                
                                <div class="flex-1 min-w-0">
                                    <span class="font-medium text-gray-800" x-text="exercise.name"></span>
                                    <span class="block text-sm text-gray-500" x-text="getAdjustedSets(exercise.sets)"></span>
                                </div>

                                <div class="w-6 h-6 ml-3 flex-shrink-0 rounded-md border-2 border-gray-300 flex items-center justify-center transition-all duration-200"
                                     :class="{ 'bg-indigo-600 border-indigo-600': exercise.completed }">
                                    <svg class="w-4 h-4 text-white check-icon" :class="{ 'check-icon': !exercise.completed }" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                </div>
                            </label>
                            <div class="pl-16 pr-3 pb-2 pt-1 text-sm text-gray-600" x-text="exercise.description"></div>
                        </div>
                    </template>
                    <button @click="clearDay('miercoles')" class="w-full text-center text-sm text-gray-500 hover:text-red-500 transition-colors duration-200 mt-4">Limpiar checks</button>
                </div>

                <!-- JUEVES --><div x-show="activeTab === 'jueves'" x-cloak class="space-y-4">
                    <h2 class="text-xl font-semibold text-indigo-600">Pecho / Hombro</h2>
                    <template x-for="(exercise, index) in getFilteredExercises('jueves')" :key="index">
                        <div class="exercise-item">
                            <input :id="'jueves-' + index" type="checkbox" class="hidden" x-model="exercise.completed" @change="saveProgress()">
                            <label :for="'jueves-' + index" 
                                   class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 cursor-pointer border border-gray-200">
                                <div class="mr-4 flex-shrink-0 w-12 h-12 flex items-center justify-center text-3xl">
                                    <span x-text="getIcon(exercise.type)"></span>
                                </div>
                                
                                <div class="flex-1 min-w-0">
                                    <span class="font-medium text-gray-800" x-text="exercise.name"></span>
                                    <span class="block text-sm text-gray-500" x-text="getAdjustedSets(exercise.sets)"></span>
                                </div>

                                <div class="w-6 h-6 ml-3 flex-shrink-0 rounded-md border-2 border-gray-300 flex items-center justify-center transition-all duration-200"
                                     :class="{ 'bg-indigo-600 border-indigo-600': exercise.completed }">
                                    <svg class="w-4 h-4 text-white check-icon" :class="{ 'check-icon': !exercise.completed }" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                </div>
                            </label>
                            <div class="pl-16 pr-3 pb-2 pt-1 text-sm text-gray-600" x-text="exercise.description"></div>
                        </div>
                    </template>
                    <button @click="clearDay('jueves')" class="w-full text-center text-sm text-gray-500 hover:text-red-500 transition-colors duration-200 mt-4">Limpiar checks</button>
                </div>

                <!-- VIERNES --><div x-show="activeTab === 'viernes'" x-cloak class="space-y-4">
                    <h2 class="text-xl font-semibold text-indigo-600">Espalda / B√≠cep</h2>
                    <template x-for="(exercise, index) in getFilteredExercises('viernes')" :key="index">
                        <div class="exercise-item">
                            <input :id="'viernes-' + index" type="checkbox" class="hidden" x-model="exercise.completed" @change="saveProgress()">
                            <label :for="'viernes-' + index" 
                                   class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 cursor-pointer border border-gray-200">
                                <div class="mr-4 flex-shrink-0 w-12 h-12 flex items-center justify-center text-3xl">
                                    <span x-text="getIcon(exercise.type)"></span>
                                </div>
                                
                                <div class="flex-1 min-w-0">
                                    <span class="font-medium text-gray-800" x-text="exercise.name"></span>
                                    <span class="block text-sm text-gray-500" x-text="getAdjustedSets(exercise.sets)"></span>
                                </div>

                                <div class="w-6 h-6 ml-3 flex-shrink-0 rounded-md border-2 border-gray-300 flex items-center justify-center transition-all duration-200"
                                     :class="{ 'bg-indigo-600 border-indigo-600': exercise.completed }">
                                    <svg class="w-4 h-4 text-white check-icon" :class="{ 'check-icon': !exercise.completed }" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                </div>
                            </label>
                            <div class="pl-16 pr-3 pb-2 pt-1 text-sm text-gray-600" x-text="exercise.description"></div>
                        </div>
                    </template>
                    <button @click="clearDay('viernes')" class="w-full text-center text-sm text-gray-500 hover:text-red-500 transition-colors duration-200 mt-4">Limpiar checks</button>
                </div>

                <!-- S√ÅBADO --><div x-show="activeTab === 'sabado'" x-cloak class="space-y-4">
                    <h2 class="text-xl font-semibold text-indigo-600">Pierna / Tr√≠cep</h2>
                    <template x-for="(exercise, index) in getFilteredExercises('sabado')" :key="index">
                        <div class="exercise-item">
                            <input :id="'sabado-' + index" type="checkbox" class="hidden" x-model="exercise.completed" @change="saveProgress()">
                            <label :for="'sabado-' + index" 
                                   class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 cursor-pointer border border-gray-200">
                                <div class="mr-4 flex-shrink-0 w-12 h-12 flex items-center justify-center text-3xl">
                                    <span x-text="getIcon(exercise.type)"></span>
                                </div>
                                
                                <div class="flex-1 min-w-0">
                                    <span class="font-medium text-gray-800" x-text="exercise.name"></span>
                                    <span class="block text-sm text-gray-500" x-text="getAdjustedSets(exercise.sets)"></span>
                                </div>

                                <div class="w-6 h-6 ml-3 flex-shrink-0 rounded-md border-2 border-gray-300 flex items-center justify-center transition-all duration-200"
                                     :class="{ 'bg-indigo-600 border-indigo-600': exercise.completed }">
                                    <svg class="w-4 h-4 text-white check-icon" :class="{ 'check-icon': !exercise.completed }" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                </div>
                            </label>
                            <div class="pl-16 pr-3 pb-2 pt-1 text-sm text-gray-600" x-text="exercise.description"></div>
                        </div>
                    </template>
                    <button @click="clearDay('sabado')" class="w-full text-center text-sm text-gray-500 hover:text-red-500 transition-colors duration-200 mt-4">Limpiar checks</button>
                </div>
            </div>
        </div>
        
        <footer class="text-center text-gray-500 text-sm mt-6">
            Creado con ‚ù§Ô∏è para tu gym.
        </footer>
    </div>

    <script>
        function gymApp() {
            return {
                progression: {
                    currentPhase: 1,
                    currentWeek: 1,
                    startDate: Date.now(),
                    workoutsCompleted: 0,
                    optedIntoFull: false
                },
                
                workouts: {},

                async init() {
                    await this.loadExercises();
                    this.loadProgression();
                    this.loadProgress();
                },
                
                async loadExercises() {
                    try {
                        const response = await fetch('exercises.json');
                        if (!response.ok) {
                            throw new Error('Failed to load exercises');
                        }
                        this.workouts = await response.json();
                    } catch (e) {
                        console.error("Error loading exercises:", e);
                    }
                },
                
                loadProgression() {
                    try {
                        const saved = localStorage.getItem('gymProgression');
                        if (saved) {
                            this.progression = JSON.parse(saved);
                        }
                    } catch (e) {
                        console.error("Error loading progression:", e);
                    }
                },
                
                saveProgression() {
                    try {
                        localStorage.setItem('gymProgression', JSON.stringify(this.progression));
                    } catch (e) {
                        console.error("Error saving progression:", e);
                    }
                },
                
                getPhaseConfig() {
                    const configs = {
                        1: { title: "Fase 1: Fundaci√≥n", weeks: 2, days: ['lunes', 'miercoles', 'viernes'], exercises: 4, sets: '2x8', time: '30-40 min', guidance: 'üéØ Enf√≥cate en aprender la t√©cnica correcta. No te apures.' },
                        2: { title: "Fase 2: Construcci√≥n", weeks: 2, days: ['lunes', 'miercoles', 'viernes'], exercises: 5, sets: '3x8', time: '40-50 min', guidance: 'üí™ Aumenta el peso gradualmente. La consistencia es clave.' },
                        3: { title: "Fase 3: Volumen", weeks: 2, days: ['lunes', 'miercoles', 'viernes', 'sabado'], exercises: 6, sets: '3x10', time: '45-55 min', guidance: 'üìà A√±adimos un d√≠a m√°s. Aseg√∫rate de descansar bien.' },
                        4: { title: "Fase 4: Principiante Avanzado", weeks: 2, days: ['lunes', 'martes', 'miercoles', 'viernes'], exercises: 7, sets: '4x10', time: '50-60 min', guidance: 'üî• Casi en el programa completo. Sigue empujando.' },
                        5: { title: "Programa Completo", weeks: 999, days: ['lunes', 'martes', 'miercoles', 'jueves', 'viernes', 'sabado'], exercises: 999, sets: 'full', time: '60-75 min', guidance: '‚ö° Programa completo. Mant√©n la intensidad y escucha a tu cuerpo.' }
                    };
                    return configs[this.progression.currentPhase] || configs[1];
                },
                
                getPhaseTitle() {
                    return this.getPhaseConfig().title;
                },
                
                getRecommendedDays() {
                    const days = this.getPhaseConfig().days;
                    const dayNames = {
                        'lunes': 'Lun',
                        'martes': 'Mar',
                        'miercoles': 'Mi√©',
                        'jueves': 'Jue',
                        'viernes': 'Vie',
                        'sabado': 'S√°b'
                    };
                    return days.map(d => dayNames[d]).join(', ');
                },
                
                getPhaseGuidance() {
                    const config = this.getPhaseConfig();
                    return `${config.guidance} ‚Ä¢ Tiempo estimado: ${config.time}`;
                },
                
                getProgressPercentage() {
                    if (this.progression.optedIntoFull) return 100;
                    const totalPhases = 5;
                    const phaseProgress = ((this.progression.currentPhase - 1) / (totalPhases - 1)) * 100;
                    const config = this.getPhaseConfig();
                    const weekProgress = (this.progression.currentWeek / config.weeks) * (100 / (totalPhases - 1));
                    return Math.min(100, phaseProgress + weekProgress);
                },
                
                shouldShowDay(day) {
                    if (this.progression.optedIntoFull) return true;
                    return this.getPhaseConfig().days.includes(day);
                },
                
                getFilteredExercises(day) {
                    if (!this.workouts[day]) {
                        return [];
                    }
                    if (this.progression.optedIntoFull) {
                        return this.workouts[day];
                    }
                    const maxExercises = this.getPhaseConfig().exercises;
                    return this.workouts[day].slice(0, maxExercises);
                },
                
                getAdjustedSets(originalSets) {
                    if (this.progression.optedIntoFull) return originalSets;
                    const sets = this.getPhaseConfig().sets;
                    if (sets === 'full') return originalSets;
                    return sets;
                },
                
                shouldSuggestAdvancement() {
                    if (this.progression.optedIntoFull) return false;
                    if (this.progression.currentPhase >= 5) return false;
                    
                    const config = this.getPhaseConfig();
                    const daysInPhase = Math.floor((Date.now() - this.progression.startDate) / (1000 * 60 * 60 * 24));
                    const weeksInPhase = Math.floor(daysInPhase / 7);
                    const minWorkouts = config.days.length * config.weeks;
                    
                    return this.progression.workoutsCompleted >= minWorkouts && weeksInPhase >= config.weeks;
                },
                
                advancePhase() {
                    if (this.progression.currentPhase < 5) {
                        this.progression.currentPhase++;
                        this.progression.currentWeek = 1;
                        this.progression.startDate = Date.now();
                        this.progression.workoutsCompleted = 0;
                        this.saveProgression();
                    }
                },
                
                nextWeek() {
                    const config = this.getPhaseConfig();
                    
                    if (this.progression.currentWeek < config.weeks) {
                        this.progression.currentWeek++;
                        this.saveProgression();
                    } else if (this.progression.currentPhase < 5) {
                        this.advancePhase();
                    }
                },
                
                previousWeek() {
                    if (this.progression.currentWeek > 1) {
                        this.progression.currentWeek--;
                        this.saveProgression();
                    } else if (this.progression.currentPhase > 1) {
                        this.progression.currentPhase--;
                        const config = this.getPhaseConfig();
                        this.progression.currentWeek = config.weeks;
                        this.saveProgression();
                    }
                },
                
                skipToFull() {
                    if (confirm('¬øEst√°s seguro? El programa progresivo est√° dise√±ado para ayudarte a construir buenos h√°bitos.')) {
                        this.progression.optedIntoFull = true;
                        this.progression.currentPhase = 5;
                        this.saveProgression();
                    }
                },
                
                resetProgression() {
                    if (confirm('¬øReiniciar al programa progresivo para principiantes?')) {
                        this.progression = {
                            currentPhase: 1,
                            currentWeek: 1,
                            startDate: Date.now(),
                            workoutsCompleted: 0,
                            optedIntoFull: false
                        };
                        this.saveProgression();
                    }
                },
                
                getIcon(type) {
                    switch (type) {
                        case 'dumbbell': return 'üí™'; // B√≠ceps (representa mancuerna)
                        case 'barbell': return 'üèãÔ∏è'; // Persona levantando pesas (barra)
                        case 'cable': return '‚õìÔ∏è'; // Cadenas (polea)
                        case 'machine': return '‚öôÔ∏è'; // Engranaje (m√°quina)
                        default: return 'üí™'; // Emoji por defecto
                    }
                },

                saveProgress() {
                    try {
                        const progress = {};
                        let totalCompleted = 0;
                        Object.keys(this.workouts).forEach(day => {
                            progress[day] = this.workouts[day].map(ex => ex.completed);
                            totalCompleted += this.workouts[day].filter(ex => ex.completed).length;
                        });
                        localStorage.setItem('gymProgress', JSON.stringify(progress));
                        
                        this.progression.workoutsCompleted = Math.floor(totalCompleted / 4);
                        this.saveProgression();
                    } catch (e) {
                        console.error("Error al guardar el progreso:", e);
                    }
                },

                loadProgress() {
                    try {
                        const savedProgress = localStorage.getItem('gymProgress');
                        if (savedProgress) {
                            const progress = JSON.parse(savedProgress);
                            Object.keys(this.workouts).forEach(day => {
                                if (progress[day] && Array.isArray(progress[day])) { 
                                    this.workouts[day].forEach((exercise, index) => {
                                        if (exercise && progress[day].length > index) { 
                                            exercise.completed = progress[day][index] || false;
                                        }
                                    });
                                }
                            });
                        }
                    } catch (e) {
                        console.error("Error al cargar el progreso:", e);
                        try {
                            localStorage.removeItem('gymProgress');
                        } catch (removeError) {
                            console.error("Error al limpiar el localStorage:", removeError);
                        }
                    }
                },
                
                clearDay(day) {
                    if (!this.workouts[day]) {
                        return;
                    }
                    this.workouts[day].forEach(exercise => {
                        exercise.completed = false;
                    });
                    this.saveProgress();
                }
            }
        }
    </script>

</body>
</html>